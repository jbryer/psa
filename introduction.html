<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 1 Introduction | Applied Propensity Score Analysis with R</title>
<meta name="author" content="Jason Bryer, Ph.D.">
<meta name="description" content="The use of propensity score methods (Rosenbaum and Rubin 1983) for estimating causal effects in observational studies or certain kinds of quasi-experiments has been increasing in the social...">
<meta name="generator" content="bookdown 0.33 with bs4_book()">
<meta property="og:title" content="Chapter 1 Introduction | Applied Propensity Score Analysis with R">
<meta property="og:type" content="book">
<meta property="og:url" content="https://psa.bryer.org/introduction.html">
<meta property="og:image" content="https://psa.bryer.org/images/psa.png">
<meta property="og:description" content="The use of propensity score methods (Rosenbaum and Rubin 1983) for estimating causal effects in observational studies or certain kinds of quasi-experiments has been increasing in the social...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 1 Introduction | Applied Propensity Score Analysis with R">
<meta name="twitter:description" content="The use of propensity score methods (Rosenbaum and Rubin 1983) for estimating causal effects in observational studies or certain kinds of quasi-experiments has been increasing in the social...">
<meta name="twitter:image" content="https://psa.bryer.org/images/psa.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.2/transition.js"></script><script src="libs/bs3compat-0.4.2/tabs.js"></script><script src="libs/bs3compat-0.4.2/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Applied Propensity Score Analysis with R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Preface</a></li>
<li><a class="active" href="introduction.html"><span class="header-section-number">1</span> Introduction</a></li>
<li><a class="" href="chapter-stratification.html"><span class="header-section-number">2</span> Stratification</a></li>
<li><a class="" href="chapter-matching.html"><span class="header-section-number">3</span> Matching</a></li>
<li><a class="" href="chapter-weighting.html"><span class="header-section-number">4</span> Weighting</a></li>
<li><a class="" href="missing-data.html"><span class="header-section-number">5</span> Missing Data</a></li>
<li><a class="" href="chapter-sensitivity.html"><span class="header-section-number">6</span> Sensitivity Analysis</a></li>
<li><a class="" href="chapter-bootstrapping.html"><span class="header-section-number">7</span> Bootstrapping</a></li>
<li><a class="" href="chapter-non-binary.html"><span class="header-section-number">8</span> Non-Binary Treatments</a></li>
<li><a class="" href="chapter-multilevelpsa.html"><span class="header-section-number">9</span> Multilevel PSA</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="psa_shiny.html"><span class="header-section-number">A</span> Shiny Application</a></li>
<li><a class="" href="appendix-psranges.html"><span class="header-section-number">B</span> Propensity Score Ranges</a></li>
<li><a class="" href="appendix-psmodels.html"><span class="header-section-number">C</span> Methods for Estimating Propensity Scores</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/jbryer/psa">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="introduction" class="section level1" number="1">
<h1>
<span class="header-section-number">1</span> Introduction<a class="anchor" aria-label="anchor" href="#introduction"><i class="fas fa-link"></i></a>
</h1>
<p>The use of propensity score methods <span class="citation">(Rosenbaum and Rubin 1983)</span> for estimating causal effects in observational studies or certain kinds of quasi-experiments has been increasing in the social sciences <span class="citation">(Thoemmes and Kim 2011)</span> and in medical research <span class="citation">(Austin 2008)</span> in the last decade. Propensity score analysis (PSA) attempts to adjust selection bias that occurs due to the lack of randomization. Analysis is typically conducted in two phases where in phase I, the probability of placement in the treatment is estimated to identify matched pairs or clusters so that in phase II, comparisons on the dependent variable can be made between matched pairs or within clusters. R <span class="citation">(R Core Team 2023)</span> is ideal for conducting PSA given its wide availability of the most current statistical methods vis-à-vis add-on packages as well as its superior graphics capabilities.</p>
<p>This book will provide a theoretical overview of propensity score methods as well as illustrations and discussion of PSA applications. Methods used in phase I of PSA (i.e. models or methods for estimating propensity scores) include logistic regression, classification trees, and matching. Discussions on appropriate comparisons and estimations of effect size and confidence intervals in phase II will also be covered. The use of graphics for diagnosing covariate balance as well as summarizing overall results will be emphasized. Lastly, the extension of PSA methods for multilevel data will also be presented.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:popularity"></span>
<img src="01-Introduction_files/figure-html/popularity-1.png" alt="PSA Citations per Year" width="100%"><p class="caption">
Figure 1.1: PSA Citations per Year
</p>
</div>
<div id="counterfactual-model-for-causality" class="section level2" number="1.1">
<h2>
<span class="header-section-number">1.1</span> Counterfactual Model for Causality<a class="anchor" aria-label="anchor" href="#counterfactual-model-for-causality"><i class="fas fa-link"></i></a>
</h2>
<p>In order to understand how propensity score analysis allows us to make causal estimates from observational data, we must first understand the basic principals of causality, particulary the counterfactual model. Figure <a href="introduction.html#fig:introduction-causality">1.2</a> depicts a conterfactual model. We begin with our research subject. This can be a student, patient, rat, asteroid, or any other object we wish to know whether some condition has an effect on. Consider two parallel universes: one where the subject receives condition A and another where they receive condition B. Typically one condition is some treatment whereas the other condition is the absense of that treatment (also referred to as the control). We will use treatment and control throughout this book to refer to these two conditions. Once the individual has been exposed to the two conditions, the outcome is measured. The difference between these outcomes is the true causal effect. However, it is impossible for an object to exist in two universes at the same time, therefore we can never actually observe the true causal effect. <span class="citation">Holland (1986)</span> referred to this as the <em>Fundamental Problem of Causal Inference</em>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:introduction-causality"></span>
<img src="figures/Causality.png" alt="Theoretical Causal Model" width="100%"><p class="caption">
Figure 1.2: Theoretical Causal Model
</p>
</div>
</div>
<div id="randomized-control-trials-the-gold-standard" class="section level2" number="1.2">
<h2>
<span class="header-section-number">1.2</span> Randomized Control Trials “The Gold Standard”<a class="anchor" aria-label="anchor" href="#randomized-control-trials-the-gold-standard"><i class="fas fa-link"></i></a>
</h2>
<p>The randomized experiment has been the goals standard for estimating causal effects. Effects can be estimated using simple means between groups, or blocks in randomized block design. Randomization presumes unbiasedness and balance between groups. However, randomization is often not feasible for many reasons, especially in educational contexts.</p>
<p>The Intelligence Quotient (IQ) is a common measure of intelligence. It is designed such that the mean is 100 and the standard deviation is 15. Consider we have developed an intervention that is known to increase anyone’s IQ by 4.5 points. Figure <a href="introduction.html#fig:rct1">1.3</a> represents such a scenario with 30 individuals. The left panel has the individual’s outcome if they were assigned to the control condition (in blue) and to the treatment condition (in red). The distance between the red and blue points for any individual is 4.5, our stipulated counterfactual difference. For RCTs we only ever get to observe one outcome for any individual. The right pane represents one possible outcome from an RCT.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:rct1"></span>
<img src="01-Introduction_files/figure-html/rct1-1.png" alt="Example conterfactuals (left panel) with one possible randomized control trial." width="100%"><p class="caption">
Figure 1.3: Example conterfactuals (left panel) with one possible randomized control trial.
</p>
</div>
<p>Figure <a href="introduction.html#fig:rct2">1.4</a> includes the mean differences between treatment and control as vertical lines in blue and red, respectively. On the left where we observe the true counterfactuals the difference between the treatment (in red) and control (in blue) vertical lines is 4.5. However, on the right the difference between treatment and control is -5.3!</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:rct2"></span>
<img src="01-Introduction_files/figure-html/rct2-1.png" alt="Estimated differences for full counterfactual model and one RCT." width="100%"><p class="caption">
Figure 1.4: Estimated differences for full counterfactual model and one RCT.
</p>
</div>
<p>In this exmaple not only did the RCT not estimate the true effect, it estimated in the wrong direction. However, Figure <a href="introduction.html#fig:rctc">1.5</a> represents the distribution of effects after conducting 1,000 RCTs from the 30 individuals above. The point here is that the RCT is already compromise to estimating the true counterfactual (i.e. causal effect). It is consider the gold standard because over many trials it will nearly approximate the true counterfactual.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:rctc"></span>
<img src="01-Introduction_files/figure-html/rctc-1.png" alt="Distribution of differences across many RCTs" width="100%"><p class="caption">
Figure 1.5: Distribution of differences across many RCTs
</p>
</div>
<p>The strong ignorability assumption states that an outcome is independent of any observed or unobserved covariates under randomization. This is represented mathematically as:</p>
<p><span class="math display">\[\left( { Y }_{ i }\left( 1 \right) ,{ Y }_{ i }\left( 0 \right)  \right) \bot { T }_{ i }\]</span></p>
<p>For all <span class="math inline">\({X}_{i}\)</span></p>
<p>Therefore, it follows that the causal effect of a treatment is the difference in an individual’s outcome under the situation they were given the treatment and not (referred to as a counterfactual).</p>
<p><span class="math display">\[{\delta}_{i} = { Y }_{ i1 }-{ Y }_{ i0 }\]</span></p>
<p>However, it is impossible to directly observe \({}_{i}\) (referred to as The Fundamental Problem of Causal Inference, Holland 1986). Rubin framed this problem as a missing data problem.</p>
<div id="rubins-causal-model" class="section level3" number="1.2.1">
<h3>
<span class="header-section-number">1.2.1</span> Rubin’s Causal Model<a class="anchor" aria-label="anchor" href="#rubins-causal-model"><i class="fas fa-link"></i></a>
</h3>
</div>
</div>
<div id="conceptual-phases-of-propensity-score-analysis" class="section level2" number="1.3">
<h2>
<span class="header-section-number">1.3</span> Conceptual Phases of Propensity Score Analysis<a class="anchor" aria-label="anchor" href="#conceptual-phases-of-propensity-score-analysis"><i class="fas fa-link"></i></a>
</h2>
<p>Propensity score analysis is typically conducted in three phases, namely:</p>
<ol style="list-style-type: decimal">
<li>Model for selection bias (i.e. estimate propensity scores).</li>
<li>Estimate causal effects.</li>
<li>Check for sensitivity to unobserved confounders.</li>
</ol>
<p>The following sections will provide an overview of these phases and the details on implementing each phase using one of the three main methods for conducting PSA, stratification, matching, and weighting.</p>
<div id="phase-i-modeling-for-selection-bias" class="section level3" number="1.3.1">
<h3>
<span class="header-section-number">1.3.1</span> Phase I: Modeling for Selection Bias<a class="anchor" aria-label="anchor" href="#phase-i-modeling-for-selection-bias"><i class="fas fa-link"></i></a>
</h3>
<p>Phase one of propensity score analysis is a cyclical process where propensity scores are estimated using a statistical model, balance in observed covariates is checked, and modifications to the statistical model are modified until sufficient balance is achieved. For simplicity we will use logistic regression to estimate propensity scores throughout the book. However, will introduce classification trees in chapter <a href="chapter-stratification.html#chapter-stratification">2</a> given how they are uniquely applicable to stratification methods in and in appendix <a href="appendix-psmodels.html#appendix-psmodels">C</a> outlines some additional statistical methods, with R code, for estimating propensity scores.</p>
<div id="estimate-propensity-scores" class="section level4" number="1.3.1.1">
<h4>
<span class="header-section-number">1.3.1.1</span> Estimate Propensity Scores<a class="anchor" aria-label="anchor" href="#estimate-propensity-scores"><i class="fas fa-link"></i></a>
</h4>
<p>Propensity scores are the conditional probability of being in the treatment given a set of observed covaraites. In practice we use statistical models where the dependent variable is dichotomous. Very often logistic regression is used, but with the advances in predictive models we have an increasing number of model choices including classification trees, Bayesian models, ensemble such as random forests, and many more. To demonstrate the main features of propensity score analysis will use a simulated dataset with two pre-treatment covariates, <code>x1</code> and <code>x2</code>, treatment indicator, and an outcome variable with a treatment_effect of 2. Figure <a href="introduction.html#fig:sim-scatter">1.6</a> is a scatter plot of the simulated data.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;This simulated dataset is adapted from a &lt;a href="https://livefreeordichotomize.com/posts/2019-01-17-understanding-propensity-score-weighting/index.html"&gt;blog post&lt;/a&gt; by &lt;a href="https://www.lucymcgowan.com"&gt;Lucy D’Agostino McGowan&lt;/a&gt;&lt;/p&gt;'><sup>1</sup></a></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:sim-scatter"></span>
<img src="01-Introduction_files/figure-html/sim-scatter-1.png" alt="Scatterplot of simulated datatset" width="100%"><p class="caption">
Figure 1.6: Scatterplot of simulated datatset
</p>
</div>
<p>Figure <a href="introduction.html#fig:sim-ggpairs">1.7</a> is a pairs plot <span class="citation">(Schloerke et al. 2021)</span> showing the relationship between the covariates (i.e. <code>x1</code> and <code>x2</code>) with the outcome grouped by treatment. There is a statistically significant correlation between each of the covariates and the outcome suggesting there is selection bias that would bias any causal estimate.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:sim-ggpairs"></span>
<img src="01-Introduction_files/figure-html/sim-ggpairs-1.png" alt="Pairs plot showing the relationships between covariates, treatment, and outcome" width="100%"><p class="caption">
Figure 1.7: Pairs plot showing the relationships between covariates, treatment, and outcome
</p>
</div>
<p>Indeed a simple null hypothesis test resulted in a difference of 4.63 (<span class="math inline">\(t_{447} = -24.19\)</span>, <em>p</em> &lt; 0.01), however we setup the simulation to have a mean difference of 2!</p>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  outcome by treatment
## t = -24.188, df = 446.5, p-value &lt; 2.2e-16
## alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0
## 95 percent confidence interval:
##  -5.006033 -4.253672
## sample estimates:</code></pre>
<p>Propensity scores allow us to adjust for this selection bias.</p>
<p>After estimating the propensity scores we can plot the distributions by treatment and control as represented in figure <a href="introduction.html#fig:sim-dist">1.8</a>. Note how the distributions are skewed; treatment group is negatively skewed and the control group is positively skewed. This should hopefully make intuitive sense. As the probability of being in the treatment increases, we should see the number of treatment observations increase while the number of control observation decreases.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:sim-dist"></span>
<img src="01-Introduction_files/figure-html/sim-dist-1.png" alt="Distribution of propensity scores" width="100%"><p class="caption">
Figure 1.8: Distribution of propensity scores
</p>
</div>
</div>
<div id="evaluate-balance" class="section level4" number="1.3.1.2">
<h4>
<span class="header-section-number">1.3.1.2</span> Evaluate Balance<a class="anchor" aria-label="anchor" href="#evaluate-balance"><i class="fas fa-link"></i></a>
</h4>
</div>
</div>
<div id="phase-ii-estimate-causal-effects" class="section level3" number="1.3.2">
<h3>
<span class="header-section-number">1.3.2</span> Phase II: Estimate Causal Effects<a class="anchor" aria-label="anchor" href="#phase-ii-estimate-causal-effects"><i class="fas fa-link"></i></a>
</h3>
<p>Chapter <a href="chapter-weighting.html#chapter-weighting">4</a></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:sim-loess"></span>
<img src="01-Introduction_files/figure-html/sim-loess-1.png" alt="Scatter plot of propensity scores against outcome with Loess regression lines" width="100%"><p class="caption">
Figure 1.9: Scatter plot of propensity scores against outcome with Loess regression lines
</p>
</div>
<div id="average-treatment_effect-ate" class="section level4" number="1.3.2.1">
<h4>
<span class="header-section-number">1.3.2.1</span> Average treatment_effect (ATE)<a class="anchor" aria-label="anchor" href="#average-treatment_effect-ate"><i class="fas fa-link"></i></a>
</h4>
<p><span class="math display">\[ ATE = E(Y_1 - Y_0 | X) = E(Y_1|X) - E(Y_0|X) \]</span>
Figure <a href="introduction.html#fig:ate-hist">1.10</a></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ate-hist"></span>
<img src="01-Introduction_files/figure-html/ate-hist-1.png" alt="Histogram of average treatement effect" width="100%"><p class="caption">
Figure 1.10: Histogram of average treatement effect
</p>
</div>
</div>
<div id="average-treatment_effect-among-the-treated-att" class="section level4" number="1.3.2.2">
<h4>
<span class="header-section-number">1.3.2.2</span> Average treatment_effect Among the Treated (ATT)<a class="anchor" aria-label="anchor" href="#average-treatment_effect-among-the-treated-att"><i class="fas fa-link"></i></a>
</h4>
<p><span class="math display">\[ ATT = E(Y_1 - Y_0 | X = 1) = E(Y_1 | X = 1) - E(Y_0 | X = 1) \]</span>
Figure <a href="introduction.html#fig:att-hist">1.11</a></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:att-hist"></span>
<img src="01-Introduction_files/figure-html/att-hist-1.png" alt="Histogram of average treatement among the treated" width="100%"><p class="caption">
Figure 1.11: Histogram of average treatement among the treated
</p>
</div>
</div>
<div id="average-treatment_effect-among-the-control-atc" class="section level4" number="1.3.2.3">
<h4>
<span class="header-section-number">1.3.2.3</span> Average treatment_effect Among the Control (ATC)<a class="anchor" aria-label="anchor" href="#average-treatment_effect-among-the-control-atc"><i class="fas fa-link"></i></a>
</h4>
<p><span class="math display">\[ ATC = E(Y_1 - Y_0 | X = 0) = E(Y_1 | X = 0) - E(Y_0 | X = 0) \]</span></p>
<p>Figure <a href="introduction.html#fig:atc-hist">1.12</a></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:atc-hist"></span>
<img src="01-Introduction_files/figure-html/atc-hist-1.png" alt="Histogram of average treatement among the control" width="100%"><p class="caption">
Figure 1.12: Histogram of average treatement among the control
</p>
</div>
</div>
<div id="average-treatment_effect-among-the-evenly-matched-atm" class="section level4" number="1.3.2.4">
<h4>
<span class="header-section-number">1.3.2.4</span> Average treatment_effect Among the Evenly Matched (ATM)<a class="anchor" aria-label="anchor" href="#average-treatment_effect-among-the-evenly-matched-atm"><i class="fas fa-link"></i></a>
</h4>
<p><span class="citation">Li and Greene (2013)</span></p>
<p><span class="math display">\[ ATM_d = E(Y_1 - Y_0 | M_d = 1) \]</span></p>
<p>Figure <a href="introduction.html#fig:acm-hist">1.13</a></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:acm-hist"></span>
<img src="01-Introduction_files/figure-html/acm-hist-1.png" alt="Histogram of average treatment_effect among the evenly matched" width="100%"><p class="caption">
Figure 1.13: Histogram of average treatment_effect among the evenly matched
</p>
</div>
</div>
</div>
<div id="phase-iii-sensitivity-analysis" class="section level3" number="1.3.3">
<h3>
<span class="header-section-number">1.3.3</span> Phase III: Sensitivity Analysis<a class="anchor" aria-label="anchor" href="#phase-iii-sensitivity-analysis"><i class="fas fa-link"></i></a>
</h3>
</div>
</div>
<div id="r-primer" class="section level2" number="1.4">
<h2>
<span class="header-section-number">1.4</span> R Primer<a class="anchor" aria-label="anchor" href="#r-primer"><i class="fas fa-link"></i></a>
</h2>
<p>R is a statistical software language designed to be extended vis-à-vis packages. As of April 03, 2023, there are currently 19,330 packages available on <a href="https://cran.r-project.org">CRAN</a>. Given the ease by which R can be extended, it has become the tool of choice for conducting propensity score analysis. This book will make use of a number of packages matching, multiple imputation of missing values, and to visualize results.</p>
<ul>
<li>
<a href="http://gking.harvard.edu/gking/matchit"><code>MatchIt</code></a> <span class="citation">(Ho et al. 2023)</span> Nonparametric Preprocessing for Parametric Causal Inference</li>
<li>
<a href="http://sekhon.berkeley.edu/matching/"><code>Matching</code></a> <span class="citation">(Singh Sekhon and Saarinen 2022)</span> Multivariate and Propensity Score Matching Software for Causal Inference</li>
<li>
<a href="https://github.com/jbryer/multilevelPSA"><code>multilevelPSA</code></a> <span class="citation">(Bryer 2018)</span> Multilevel Propensity Score Analysis</li>
<li>
<a href="http://cran.r-project.org/web/packages/party/index.html"><code>party</code></a> <span class="citation">(Hothorn et al. 2023)</span> A Laboratory for Recursive Partytioning</li>
<li>
<a href="https://github.com/jbryer/PSAboot"><code>PSAboot</code></a> <span class="citation">(Bryer 2023)</span> Bootstrapping for Propensity Score Analysis</li>
<li>
<a href="http://www.jstatsoft.org/v29/i06/paper"><code>PSAgraphics</code></a> <span class="citation">(Helmreich and Pruzek 2023)</span> An R Package to Support Propensity Score Analysis</li>
<li>
<a href="http://www.personal.psu.edu/ljk20/rbounds%20vignette.pdf"><code>rbounds</code></a> <span class="citation">(Keele 2022)</span> An Overview of rebounds: An R Package for Rosenbaum bounds sensitivity analysis with matched data.</li>
<li>
<a href="http://cran.r-project.org/web/packages/rpart/index.html"><code>rpart</code></a> <span class="citation">(Therneau and Atkinson 2022)</span> Recursive Partitioning</li>
<li>
<a href="https://github.com/jbryer/TriMatch"><code>TriMatch</code></a> <span class="citation">(Bryer 2017)</span> Propensity Score Matching for Non-Binary Treatments</li>
</ul>
<p>The following command will install the R packages we will use in this book.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pkgs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'granova'</span>, <span class="st">'granovaGG'</span>, <span class="st">'Matching'</span>, <span class="st">'MatchIt'</span>, <span class="st">'mice'</span>, </span>
<span>          <span class="st">'multilevelPSA'</span>, <span class="st">'party'</span>, <span class="st">'PSAboot'</span>, <span class="st">'PSAgraphics'</span>, <span class="st">'rbounds'</span>, </span>
<span>          <span class="st">'TriMatch'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="va">pkgs</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="datasets" class="section level2" number="1.5">
<h2>
<span class="header-section-number">1.5</span> Datasets<a class="anchor" aria-label="anchor" href="#datasets"><i class="fas fa-link"></i></a>
</h2>
<div id="lalonde" class="section level3" number="1.5.1">
<h3>
<span class="header-section-number">1.5.1</span> National Supported Work Demonstration<a class="anchor" aria-label="anchor" href="#lalonde"><i class="fas fa-link"></i></a>
</h3>
<p>The <code>lalonde</code> dataset is perhaps one of the most used datasets when introducing or evaluating propensity score methods. The data was collected by <span class="citation">Lalonde (1986)</span> but became widely used in the PSA literature after <span class="citation">Dehejia and Wahba (1999)</span> used it in their paper to evaluate propensity score matching. The dataset originated from the National Supported Work Demonstration study conducted in the 1970s. The program provided 12 to 18 months of employment to people with longstanding employment problems. The dataset contains 445 observations of 12 variables. The primary outcome is <code>re78</code> which is real earnings in 1978. Observed covariates used to ajdust for selection bias include <code>age</code> (age in years), <code>edu</code> (number of years of education), <code>black</code> (black or not), <code>hisp</code> (Hispanic or not), <code>married</code> (married or not), <code>nodegr</code> (whether the worker has a degree or not, note that 1 = no degree), <code>re74</code> (real earnings in 1974), and <code>re75</code> (real earnings in 1975).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">lalonde</span>, package<span class="op">=</span><span class="st">'Matching'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">lalonde</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 'data.frame':    445 obs. of  12 variables:
##  $ age    : int  37 22 30 27 33 22 23 32 22 33 ...
##  $ educ   : int  11 9 12 11 8 9 12 11 16 12 ...
##  $ black  : int  1 0 1 1 1 1 1 1 1 0 ...
##  $ hisp   : int  0 1 0 0 0 0 0 0 0 0 ...
##  $ married: int  1 0 0 0 0 0 0 0 0 1 ...
##  $ nodegr : int  1 1 0 1 1 1 0 1 0 0 ...
##  $ re74   : num  0 0 0 0 0 0 0 0 0 0 ...
##  $ re75   : num  0 0 0 0 0 0 0 0 0 0 ...
##  $ re78   : num  9930 3596 24910 7506 290 ...
##  $ u74    : int  1 1 1 1 1 1 1 1 1 1 ...
##  $ u75    : int  1 1 1 1 1 1 1 1 1 1 ...
##  $ treat  : int  1 1 1 1 1 1 1 1 1 1 ...</code></pre>
</div>
<div id="lindner" class="section level3" number="1.5.2">
<h3>
<span class="header-section-number">1.5.2</span> Lindner Center<a class="anchor" aria-label="anchor" href="#lindner"><i class="fas fa-link"></i></a>
</h3>
<p>Data from an observational study of 996 patients receiving a PCI at Ohio Heart Health in 1997 and followed for at least 6 months by the staff of the Lindner Center. This is a landmark dataset in the literature on propensity score adjustment for treatment selection bias due to practice of evidence based medicine; patients receiving <code>abciximab</code> tended to be more severely diseased than those who did not receive a IIb/IIIa cascade blocker.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">lindner</span>, package<span class="op">=</span><span class="st">'PSAgraphics'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">lindner</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 'data.frame':    996 obs. of  10 variables:
##  $ lifepres: num  0 11.6 11.6 11.6 11.6 11.6 11.6 11.6 11.6 11.6 ...
##  $ cardbill: int  14301 3563 4694 7366 8247 8319 8410 8517 8763 8823 ...
##  $ abcix   : int  1 1 1 1 1 1 1 1 1 1 ...
##  $ stent   : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ height  : int  163 168 188 175 168 178 185 173 152 180 ...
##  $ female  : int  1 0 0 0 1 0 0 1 1 0 ...
##  $ diabetic: int  1 0 0 1 0 0 0 0 0 0 ...
##  $ acutemi : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ ejecfrac: int  56 56 50 50 55 50 58 30 60 60 ...
##  $ ves1proc: int  1 1 1 1 1 1 1 1 1 1 ...</code></pre>
</div>
<div id="tutoring" class="section level3" number="1.5.3">
<h3>
<span class="header-section-number">1.5.3</span> Tutoring<a class="anchor" aria-label="anchor" href="#tutoring"><i class="fas fa-link"></i></a>
</h3>
<p>The <code>tutoring</code> dataset originates from a study conducted at an online adult serving institution examining the effects of tutoring services for students in English 101, English 201, and History 310. Tutoring services were available to all students but Treatment (<code>treat</code>) is operationalized as students who used tutoring services at least once during the course. Only 19.6% of students used tutoring services with approximately half using it more than once. We will use this dataset with both a dichotomous treatment (used tutoring or not) or as a two level treatment (used tutoring services once, used tutoring services two or more times).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">tutoring</span>, package<span class="op">=</span><span class="st">'TriMatch'</span><span class="op">)</span></span>
<span><span class="va">tutoring</span><span class="op">$</span><span class="va">treat2</span> <span class="op">&lt;-</span> <span class="va">tutoring</span><span class="op">$</span><span class="va">treat</span> <span class="op">!=</span> <span class="st">'Control'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">tutoring</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 'data.frame':    1142 obs. of  18 variables:
##  $ treat     : Factor w/ 3 levels "Control","Treat1",..: 1 1 1 1 1 2 1 1 1 1 ...
##  $ Course    : chr  "ENG*201" "ENG*201" "ENG*201" "ENG*201" ...
##  $ Grade     : int  4 4 4 4 4 3 4 3 0 4 ...
##  $ Gender    : Factor w/ 2 levels "FEMALE","MALE": 1 1 1 1 1 1 1 1 1 1 ...
##  $ Ethnicity : Factor w/ 3 levels "Black","Other",..: 2 3 3 3 3 3 3 3 1 3 ...
##  $ Military  : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...
##  $ ESL       : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...
##  $ EdMother  : int  3 5 1 3 2 3 4 4 3 6 ...
##  $ EdFather  : int  6 6 1 5 2 3 4 4 2 6 ...
##  $ Age       : num  48 49 53 52 47 53 54 54 59 40 ...
##  $ Employment: int  3 3 1 3 1 3 3 3 1 3 ...
##  $ Income    : num  9 9 5 5 5 9 6 6 1 8 ...
##  $ Transfer  : num  24 25 39 48 23 ...
##  $ GPA       : num  3 2.72 2.71 4 3.5 3.55 3.57 3.57 3.43 2.81 ...
##  $ GradeCode : chr  "A" "A" "A" "A" ...
##  $ Level     : Factor w/ 2 levels "Lower","Upper": 1 1 1 1 1 2 1 1 1 1 ...
##  $ ID        : int  377 882 292 215 252 265 1016 282 39 911 ...
##  $ treat2    : logi  FALSE FALSE FALSE FALSE FALSE TRUE ...</code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">tutoring</span><span class="op">$</span><span class="va">Course</span>, <span class="va">tutoring</span><span class="op">$</span><span class="va">treat</span><span class="op">)</span></span></code></pre></div>
<pre><code>##          
##           Control Treat1 Treat2
##   ENG*101     349     22     31
##   ENG*201     518     36     32
##   HSC*310      51     76     27</code></pre>
</div>
<div id="pisa" class="section level3" number="1.5.4">
<h3>
<span class="header-section-number">1.5.4</span> Programme of International Student Assessment (PISA)<a class="anchor" aria-label="anchor" href="#pisa"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">pisana</span>, package<span class="op">=</span><span class="st">'multilevelPSA'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">pisana</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 'data.frame':    66548 obs. of  65 variables:
##  $ Country : chr  "Canada" "Canada" "Canada" "Canada" ...
##  $ CNT     : chr  "CAN" "CAN" "CAN" "CAN" ...
##  $ SCHOOLID: Factor w/ 1534 levels "00001","00002",..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ ST01Q01 : Factor w/ 0 levels: NA NA NA NA NA NA NA NA NA NA ...
##  $ ST04Q01 : Factor w/ 2 levels "Female","Male": 1 2 2 1 2 2 2 1 1 2 ...
##  $ ST05Q01 : Factor w/ 3 levels "No","Yes, more than one year",..: 2 2 3 2 1 1 3 3 2 3 ...
##  $ ST06Q01 : num  4 4 4 4 5 5 5 4 4 5 ...
##  $ ST07Q01 : Factor w/ 3 levels "No, never","Yes, once",..: 1 1 1 1 1 1 2 1 1 1 ...
##  $ ST08Q01 : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 2 2 2 2 2 ...
##  $ ST08Q02 : Factor w/ 2 levels "No","Yes": 2 2 2 1 2 2 1 2 2 2 ...
##  $ ST08Q03 : Factor w/ 2 levels "No","Yes": 1 2 2 2 1 1 1 2 2 2 ...
##  $ ST08Q04 : Factor w/ 2 levels "No","Yes": 2 2 1 2 2 2 2 1 2 1 ...
##  $ ST08Q05 : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
##  $ ST08Q06 : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
##  $ ST10Q01 : Factor w/ 5 levels "&lt;ISCED level 1&gt;",..: 3 3 3 3 3 3 3 3 3 3 ...
##  $ ST12Q01 : Factor w/ 4 levels "Looking for work",..: 3 3 3 3 3 3 3 3 4 3 ...
##  $ ST14Q01 : Factor w/ 5 levels "&lt;ISCED level 1&gt;",..: 3 3 3 3 3 3 3 3 3 3 ...
##  $ ST16Q01 : Factor w/ 4 levels "Looking for work",..: 3 3 3 3 3 3 3 3 4 3 ...
##  $ ST19Q01 : Factor w/ 2 levels "Another language",..: 2 2 2 1 2 2 2 2 2 1 ...
##  $ ST20Q01 : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 2 2 2 2 2 ...
##  $ ST20Q02 : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 2 2 2 2 2 ...
##  $ ST20Q03 : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 2 2 2 2 2 ...
##  $ ST20Q04 : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 2 2 2 2 2 ...
##  $ ST20Q05 : Factor w/ 2 levels "No","Yes": 2 2 2 2 1 2 2 2 2 1 ...
##  $ ST20Q06 : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 2 2 2 2 2 ...
##  $ ST20Q07 : Factor w/ 2 levels "No","Yes": 2 2 1 2 1 1 1 1 1 1 ...
##  $ ST20Q08 : Factor w/ 2 levels "No","Yes": 2 2 1 2 1 2 1 1 1 1 ...
##  $ ST20Q09 : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 2 2 1 1 2 ...
##  $ ST20Q10 : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 2 2 2 2 1 ...
##  $ ST20Q12 : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 2 2 2 2 2 ...
##  $ ST20Q13 : Factor w/ 2 levels "No","Yes": 2 2 1 2 2 2 2 2 2 2 ...
##  $ ST20Q14 : Factor w/ 2 levels "No","Yes": 2 2 2 2 2 2 2 2 2 2 ...
##  $ ST21Q01 : Factor w/ 4 levels "None","One","Three or more",..: 3 3 3 3 3 4 4 3 3 3 ...
##  $ ST21Q02 : Factor w/ 4 levels "None","One","Three or more",..: 3 3 3 3 4 3 2 3 3 3 ...
##  $ ST21Q03 : Factor w/ 4 levels "None","One","Three or more",..: 3 2 2 3 4 4 4 4 3 3 ...
##  $ ST21Q04 : Factor w/ 4 levels "None","One","Three or more",..: 4 4 2 3 4 3 2 4 4 3 ...
##  $ ST21Q05 : Factor w/ 4 levels "None","One","Three or more",..: 2 4 4 3 3 4 2 4 4 3 ...
##  $ ST22Q01 : Factor w/ 6 levels "0-10 books","101-200 books",..: 5 5 1 5 4 3 2 5 4 1 ...
##  $ ST23Q01 : Factor w/ 5 levels "1 to 2 hours a day",..: 5 2 4 2 4 4 3 4 3 4 ...
##  $ ST31Q01 : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
##  $ ST31Q02 : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 2 ...
##  $ ST31Q03 : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
##  $ ST31Q05 : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 2 1 ...
##  $ ST31Q06 : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 2 1 ...
##  $ ST31Q07 : Factor w/ 2 levels "No","Yes": 2 1 1 1 1 1 1 1 2 1 ...
##  $ ST32Q01 : Factor w/ 5 levels "2 up to 4 Hours a week",..: 4 4 5 4 4 4 4 4 4 4 ...
##  $ ST32Q02 : Factor w/ 5 levels "2 up to 4 Hours a week",..: 5 4 5 4 4 4 4 4 4 5 ...
##  $ ST32Q03 : Factor w/ 5 levels "2 up to 4 Hours a week",..: 4 4 5 4 4 4 4 4 4 5 ...
##  $ PV1MATH : num  474 673 348 518 420 ...
##  $ PV2MATH : num  466 632 372 537 533 ...
##  $ PV3MATH : num  438 571 397 511 441 ...
##  $ PV4MATH : num  458 685 445 527 468 ...
##  $ PV5MATH : num  471 586 375 490 420 ...
##  $ PV1READ : num  503 613 390 570 407 ...
##  $ PV2READ : num  492 578 421 542 452 ...
##  $ PV3READ : num  522 553 442 527 434 ...
##  $ PV4READ : num  509 594 410 584 423 ...
##  $ PV5READ : num  460 564 372 518 416 ...
##  $ PV1SCIE : num  460 686 378 500 417 ...
##  $ PV2SCIE : num  444 589 399 575 556 ...
##  $ PV3SCIE : num  484 593 388 505 471 ...
##  $ PV4SCIE : num  489 643 444 540 436 ...
##  $ PV5SCIE : num  435 646 385 476 479 ...
##  $ PUBPRIV : Factor w/ 2 levels "Private","Public": 2 2 2 2 2 2 2 2 2 2 ...
##  $ STRATIO : num  14.4 14.4 14.4 14.4 14.4 ...</code></pre>
</div>
<div id="nmes" class="section level3" number="1.5.5">
<h3>
<span class="header-section-number">1.5.5</span> National Medical Expenditure Study<a class="anchor" aria-label="anchor" href="#nmes"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">nmes</span>, package<span class="op">=</span><span class="st">'TriMatch'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">nmes</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 'data.frame':    20622 obs. of  29 variables:
##  $ PIDX     : int  20843014 20836012 20836025 20835019 20832010 20829011 20825018 20821016 20819010 20819023 ...
##  $ LASTAGE  : int  80 29 28 29 80 71 60 82 32 33 ...
##  $ MALE     : int  0 0 1 0 1 1 0 0 1 0 ...
##  $ RACE3    : Factor w/ 3 levels "1","2","3": 3 3 3 3 3 3 3 3 3 3 ...
##  $ eversmk  : int  0 1 1 1 1 1 1 1 1 0 ...
##  $ current  : int  NA 1 1 1 1 0 0 0 0 NA ...
##  $ former   : int  0 0 0 0 0 1 1 1 1 0 ...
##  $ smoke    : Factor w/ 3 levels "0","1","2": 1 2 2 2 2 3 3 3 3 1 ...
##  $ AGESMOKE : int  NA 15 16 17 21 16 30 16 12 NA ...
##  $ CIGSSMOK : int  NA 20 18 NA 10 NA 20 2 25 NA ...
##  $ SMOKENOW : int  NA 1 1 1 1 2 2 2 2 NA ...
##  $ SMOKED   : int  2 1 1 1 1 1 1 1 1 2 ...
##  $ CIGSADAY : int  NA 35 19 NA 10 NA NA NA NA NA ...
##  $ AGESTOP  : int  NA NA NA NA NA 46 38 35 29 NA ...
##  $ packyears: num  0 15 11.7 NA 30 NA 9 2 22.5 0 ...
##  $ yearsince: int  0 0 0 0 0 25 22 47 3 0 ...
##  $ INCALPER : num  5806 9952 10839 13990 8221 ...
##  $ HSQACCWT : num  6933 10607 11500 14766 9512 ...
##  $ TOTALEXP : num  298 284 177 750 1369 ...
##  $ TOTALSP3 : num  20 0 0 0 0 ...
##  $ lc5      : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ chd5     : int  1 0 0 0 1 0 0 0 0 0 ...
##  $ beltuse  : Factor w/ 3 levels "1","2","3": 3 3 2 2 1 3 3 3 3 3 ...
##  $ educate  : Factor w/ 4 levels "1","2","3","4": 1 1 1 1 1 1 1 1 1 1 ...
##  $ marital  : Factor w/ 5 levels "1","2","3","4",..: 2 1 1 5 3 1 5 5 1 1 ...
##  $ SREGION  : Factor w/ 4 levels "1","2","3","4": 1 1 1 1 1 1 1 1 1 1 ...
##  $ POVSTALB : Factor w/ 5 levels "1","2","3","4",..: 1 3 3 4 3 5 5 4 5 5 ...
##  $ flag     : int  0 0 0 2 0 2 0 0 0 0 ...
##  $ age      : int  1 0 0 0 1 1 1 1 0 0 ...</code></pre>

</div>
</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="index.html">Preface</a></div>
<div class="next"><a href="chapter-stratification.html"><span class="header-section-number">2</span> Stratification</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#introduction"><span class="header-section-number">1</span> Introduction</a></li>
<li><a class="nav-link" href="#counterfactual-model-for-causality"><span class="header-section-number">1.1</span> Counterfactual Model for Causality</a></li>
<li>
<a class="nav-link" href="#randomized-control-trials-the-gold-standard"><span class="header-section-number">1.2</span> Randomized Control Trials “The Gold Standard”</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#rubins-causal-model"><span class="header-section-number">1.2.1</span> Rubin’s Causal Model</a></li></ul>
</li>
<li>
<a class="nav-link" href="#conceptual-phases-of-propensity-score-analysis"><span class="header-section-number">1.3</span> Conceptual Phases of Propensity Score Analysis</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#phase-i-modeling-for-selection-bias"><span class="header-section-number">1.3.1</span> Phase I: Modeling for Selection Bias</a></li>
<li><a class="nav-link" href="#phase-ii-estimate-causal-effects"><span class="header-section-number">1.3.2</span> Phase II: Estimate Causal Effects</a></li>
<li><a class="nav-link" href="#phase-iii-sensitivity-analysis"><span class="header-section-number">1.3.3</span> Phase III: Sensitivity Analysis</a></li>
</ul>
</li>
<li><a class="nav-link" href="#r-primer"><span class="header-section-number">1.4</span> R Primer</a></li>
<li>
<a class="nav-link" href="#datasets"><span class="header-section-number">1.5</span> Datasets</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#lalonde"><span class="header-section-number">1.5.1</span> National Supported Work Demonstration</a></li>
<li><a class="nav-link" href="#lindner"><span class="header-section-number">1.5.2</span> Lindner Center</a></li>
<li><a class="nav-link" href="#tutoring"><span class="header-section-number">1.5.3</span> Tutoring</a></li>
<li><a class="nav-link" href="#pisa"><span class="header-section-number">1.5.4</span> Programme of International Student Assessment (PISA)</a></li>
<li><a class="nav-link" href="#nmes"><span class="header-section-number">1.5.5</span> National Medical Expenditure Study</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/jbryer/psa/blob/master/book/01-Introduction.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/jbryer/psa/edit/master/book/01-Introduction.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Applied Propensity Score Analysis with R</strong>" was written by Jason Bryer, Ph.D.. It was last built on 2023-04-03.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
